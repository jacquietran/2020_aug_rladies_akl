---
title: "Reproducible reports in R Markdown"
author: "Jacquie Tran | @jacquietran | 18 Aug 2020"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
---

```{r setup, include=FALSE}

options(htmltools.dir.version = FALSE)

# Load libraries
library(xaringanthemer)
library(paletteer)

```

```{r xaringan-themer, include=FALSE, warning=FALSE}

style_duo_accent_inverse(
  primary_color = "#E84A5F",
  secondary_color = "#FF847C"
)
```

class: inverse, center, middle

# From academia to industry

---
class: right, bottom
background-image: url(https://raw.githubusercontent.com/jacquietran/2020_aug_rladies_akl/master/images/andrew-petrischev-X03NgRx9f6A-unsplash.jpg)
background-size: 35%

.small[
Image credit: [Andrew Petrischev](https://unsplash.com/photos/X03NgRx9f6A)
]

---
class: right, bottom
background-image: url(https://raw.githubusercontent.com/jacquietran/2020_aug_rladies_akl/master/images/emil-widlund-ZtI4l8EvyUw-unsplash.jpg)
background-size: 35%

Image credit: [Emil Widlund](https://unsplash.com/photos/ZtI4l8EvyUw)

---

## Starting from the middle of a data project

Where are all the project files stored?

--

Where did the data come from?

--

What was done to the data?

--

What analytical choices were made and why?

--

How were the data outputs produced?

---
class: inverse, center, middle

# What makes a report reproducible?

---
class: middle

> "Statisticians write a lot of reports, describing the results of data analyses.
>
> It’s best if such reports are fully reproducible: that **the data and code are available**, and that there’s a **clear and automatic path from data and code to the final report**."
> 
> Karl Broman | https://kbroman.org/Tools4RR/assets/lectures/03_knitr_Rmd_withnotes.pdf

---

## Four facets of reproducibility

The Carpentries, [Reproducible Research with R](https://datacarpentry.org/rr-intro/01-introduction/index.html)

--

1. Documentation

--

2. Organisation

--

3. Automation

--

4. Dissemination

---
class: inverse, center, middle

# Case study

---

## Familiarising with a pilot project

Where are all the project files stored?

--
> On **one person's local machine**.

Where did the data come from?

--
> **Spreadsheets** exported from SurveyMonkey.

--

What was done to the data?

--
> Data cleaning in **Excel (point-and-click)**; statistical analyses in **Stata**.

--

What analytical choices were made and why?

--
> **?????**

--

How were the data outputs produced?

--
> Report written in **Word**; plots generated in Excel and **copied from Excel into Word**; statistical results **typed into Word**.

---
class: inverse, center, middle

## Take the same project, but make it ~~fashion~~ *reproducible*

---

## Where are all the project files stored?

**GitHub** repository for all code and code-related documentation.

---

## Where does the data come from?

Data is pulled from the SurveyMonkey API into a **SQL datamart**

--

Data is retrieved using the **{RODBC}** package in an **R Markdown** file.

--

```{r, eval = FALSE}

library(RODBC)

# Create object for connecting to the SQL datamart -----------------------------

con <- odbcConnect("datamart_name", uid = "username", pwd = "password")

# Import data from SQL datamart ------------------------------------------------

source_data <- sqlQuery(
  con, "SELECT * FROM [datamart].[schema].[view]")

```

---

## What is done to the data?

Data cleaning in **SQL**.

Additional wrangling, analyses, and plots within the **R Markdown** file.

---

## What analytical choices were made and why?

Choices are documented in:

- GitHub issues
- Markdown files in the GitHub repo
- Comments embedded into the R Markdown file.

---

## How were the data outputs produced?

Knit the R Markdown file to Word, et voila!

---

## Benefits of a more reproducible approach

Retrace our own steps

--

Enables teamwork

--

Version control

--

Rigour

--

Speed

--

Modularity

---
class: inverse, center, middle

# Start the way you mean to go on!

---

## Useful links

[R Markdown articles from R Studio](https://rmarkdown.rstudio.com/articles.html)

Yihui Xie, J.J. Allaire, & Garrett Grolemund, [R Markdown: The Definitive Guide](https://bookdown.org/yihui/rmarkdown/)

Emily Riederer, [R Markdown Driven Development](https://emilyriederer.netlify.app/post/rmarkdown-driven-development/)

The Mockup Blog (Tom Mock), [How I share knowledge around R Markdown](https://themockup.blog/posts/2020-07-25-meta-rmarkdown/)
